# AWS EKS - The Managed Office Building Analogy

> Understanding Amazon EKS as a managed office space where building management handles infrastructure, and you focus on your work.

---

## TL;DR

| AWS EKS Concept | Managed Office Analogy |
|-----------------|------------------------|
| EKS | Managed office building (like WeWork) |
| Control Plane | Building management (reception, security, utilities) |
| Data Plane | Your office floor (where your team works) |
| Standard Mode | Standard plan - building ready, you bring your team |
| Auto Mode | Full-service plan - everything provided, just work |
| API Server | Reception desk (handles all requests) |
| etcd | Filing cabinets (stores all records) |
| Scheduler | Floor assignment manager |
| Controller Manager | Building supervisors |
| Worker Nodes | Office desks/workstations |
| Pods | Your employees doing actual work |
| kubelet | Floor manager (reports to building management) |
| Cluster Security Group | Building communication protocol |
| Private Endpoint | Internal intercom system |
| Public Endpoint | Public phone number |
| ENIs | Intercom devices on your floor |

---

## The Big Picture

Imagine you want to run a business. You have two options:

**Option 1: Build Your Own Office**
Buy land, construct building, install electricity, plumbing, security systems, hire maintenance staff... everything is on you.

**Option 2: Use a Managed Office Building (EKS)**
Partner with a building management company. They provide a fully operational building - you just bring your team and focus on work.

---

## The Setup

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BUILDING MANAGEMENT (AWS Managed VPC)              â”‚
â”‚                                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚              BUILDING OPERATIONS                        â”‚ â”‚
â”‚    â”‚                (Control Plane)                          â”‚ â”‚
â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚   ğŸ“‹ Reception Desk (API Server) - handles all requestsâ”‚ â”‚
â”‚    â”‚   ğŸ—„ï¸ Filing Cabinets (etcd) - stores all records       â”‚ â”‚
â”‚    â”‚   ğŸ“… Floor Assignment (Scheduler) - assigns workspace  â”‚ â”‚
â”‚    â”‚   ğŸ‘” Supervisors (Controllers) - ensure things run     â”‚ â”‚
â”‚    â”‚                                                         â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                   â˜ï¸ Internal Intercom (ENIs)
                   (installed on YOUR floor)
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     YOUR OFFICE FLOOR                           â”‚
â”‚                        (Your VPC)                               â”‚
â”‚                           â”‚                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚              WORKSTATIONS (Worker Nodes)                â”‚ â”‚
â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚   ğŸ–¥ï¸ Desk A (Node 1)        ğŸ–¥ï¸ Desk B (Node 2)         â”‚ â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚    â”‚   â”‚ Worker 1 (Pod)  â”‚       â”‚ Worker 4 (Pod)  â”‚        â”‚ â”‚
â”‚    â”‚   â”‚ Worker 2 (Pod)  â”‚       â”‚ Worker 5 (Pod)  â”‚        â”‚ â”‚
â”‚    â”‚   â”‚ Worker 3 (Pod)  â”‚       â”‚ Worker 6 (Pod)  â”‚        â”‚ â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚   Each desk area has a Floor Manager (kubelet)         â”‚ â”‚
â”‚    â”‚   who reports to Building Management                   â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## EKS Standard vs Auto Mode

The building offers two plans:

### Standard Plan (EKS Standard)

Building management provides:
- âœ… The building (Control Plane)
- âœ… Reception, security, utilities
- âœ… Communication systems

You handle:
- ğŸ‘· Hiring your team (provisioning nodes)
- ğŸ“‹ Managing your team (node lifecycle)
- ğŸ’° Paying your staff (EC2 costs)

### Full-Service Plan (EKS Auto Mode)

Building management provides:
- âœ… Everything in Standard, PLUS
- âœ… Staff provided for you (nodes managed by AWS)
- âœ… Automatic scaling of workforce

You only:
- ğŸ¯ Define what work needs to be done (deploy pods)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      STANDARD PLAN          â”‚   â”‚     FULL-SERVICE PLAN       â”‚
â”‚                             â”‚   â”‚                             â”‚
â”‚  Building: âœ… Managed       â”‚   â”‚  Building: âœ… Managed       â”‚
â”‚  Your Team: ğŸ‘· You hire     â”‚   â”‚  Your Team: âœ… Provided     â”‚
â”‚  Your Work: ğŸ¯ You do       â”‚   â”‚  Your Work: ğŸ¯ You do       â”‚
â”‚                             â”‚   â”‚                             â”‚
â”‚  More control               â”‚   â”‚  Less hassle                â”‚
â”‚  More responsibility        â”‚   â”‚  More cost                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Compute Options - How to Staff Your Floor

In the Standard Plan, you need to hire staff. Different hiring strategies:

| Hiring Strategy | EKS Option | How It Works |
|-----------------|------------|--------------|
| **Staffing Agency** | Managed Node Groups | Tell agency "I need 5 developers". They hire, handle HR/payroll, manage lifecycle. You just supervise work. |
| **Contract Workers** | Fargate | No permanent hires. Workers appear when there's work, bill hourly, leave when done. Fully serverless. |
| **Smart Recruiter** | Karpenter | Hire a recruiter who watches workload in real-time. Hires when busy, lets go when slow. Great for cost optimization. |
| **Direct Hiring** | Self-Managed Nodes | You personally interview, hire, train, manage, fire. Full control, full responsibility. |
| **Remote Workers** | Hybrid Nodes | Staff working from another location (on-premises data center) but connected to your floor. |

### Choosing the Right Option

```
More AWS Control â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º More Your Control
     
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Auto    â”‚  Fargate â”‚  Managed  â”‚ Karpenter â”‚ Self-Managed â”‚
â”‚  Mode    â”‚          â”‚  Node Grp â”‚           â”‚  Nodes       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚          â”‚           â”‚           â”‚            â”‚
     â–¼          â–¼           â–¼           â–¼            â–¼
  Easiest   Serverless   Balanced   Smart Auto   Full Control
```

---

## Communication - How Your Floor Talks to Building Management

### The Challenge

Building Management operates from a **separate facility** (AWS Managed VPC). Your floor is in **your section** of the building (Your VPC). How do they communicate?

### Private Intercom (Private Endpoint)

Building Management installs an **internal intercom system** directly on your floor:

- Has a **local extension number** (Private IP in your VPC)
- Connected through **internal building wiring** (AWS backbone)
- Never goes through public phone lines
- This intercom = **ENIs created in your VPC**

### Public Phone Line (Public Endpoint)

Building Management also has a **public phone number**:
- Anyone can call (with proper credentials)
- Goes through public phone networks (internet)
- Less secure but accessible from anywhere

### Three Access Modes

| Mode | Analogy | When to Use |
|------|---------|-------------|
| **Public Only** | Only public phone number. Your floor managers and you call HQ on public line. | Simple setup, quick start |
| **Private Only** | Only internal intercom. Must be inside building to communicate. | Maximum security, need VPN for remote access |
| **Both Enabled** | Public phone + internal intercom. Floor managers use intercom (faster). You can call from outside. | Best of both worlds |

```
PUBLIC ONLY:
  You (anywhere) â”€â”€â”€â–º Public Phone â”€â”€â”€â–º Building Management âœ…
  Floor Manager â”€â”€â”€â–º Public Phone â”€â”€â”€â–º Building Management âœ…

PRIVATE ONLY:
  You (inside) â”€â”€â”€â–º Intercom â”€â”€â”€â–º Building Management âœ…
  You (outside) â”€â”€â”€â–º âŒ Can't reach
  Floor Manager â”€â”€â”€â–º Intercom â”€â”€â”€â–º Building Management âœ…

BOTH ENABLED:
  You (outside) â”€â”€â”€â–º Public Phone â”€â”€â”€â–º Building Management âœ…
  Floor Manager â”€â”€â”€â–º Intercom â”€â”€â”€â–º Building Management âœ… (preferred)
```

---

## Security - Building Communication Protocol

### Cluster Security Group

The building has a **Communication Protocol** that defines who can talk to whom:

| Communication | Port | Purpose |
|---------------|------|---------|
| Floor Manager â†’ Building Mgmt | 443 | Report status, get instructions |
| Building Mgmt â†’ Floor Manager | 10250 | Check on workers, direct commands |
| Floor Manager â†” Floor Manager | All | Cross-department coordination |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COMMUNICATION PROTOCOL                     â”‚
â”‚              (Cluster Security Group)                   â”‚
â”‚                                                         â”‚
â”‚   âœ… Allowed:                                           â”‚
â”‚   ğŸ“ Manager â†’ HQ (port 443): Status reports           â”‚
â”‚   ğŸ“ HQ â†’ Manager (port 10250): kubectl exec/logs      â”‚
â”‚   ğŸ“ Manager â†” Manager: Cross-floor communication      â”‚
â”‚                                                         â”‚
â”‚   âŒ Blocked:                                           â”‚
â”‚   ğŸš« Random workers calling HQ directly                â”‚
â”‚   ğŸš« Outside calls without proper credentials          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Why port 10250 matters**: When you run `kubectl exec`, `kubectl logs`, or `kubectl port-forward`, Building Management needs to reach back to the Floor Manager. If blocked, these commands fail!

---

## High Availability - Building Never Closes

Building Management takes reliability seriously:

- **Multiple reception desks (API Servers)** across different locations
- **3 copies of all records (etcd)** stored in 3 separate buildings in different parts of the city (Availability Zones)
- If one building has issues, the others continue operating seamlessly

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               BUILDING MANAGEMENT SETUP                     â”‚
â”‚                                                             â”‚
â”‚   Location A (AZ-a)    Location B (AZ-b)    Location C (AZ-c)
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Reception   â”‚      â”‚ Reception   â”‚      â”‚ Reception   â”‚ â”‚
â”‚   â”‚ (API Server)â”‚      â”‚ (API Server)â”‚      â”‚ (API Server)â”‚ â”‚
â”‚   â”‚             â”‚      â”‚             â”‚      â”‚             â”‚ â”‚
â”‚   â”‚ Records ğŸ“  â”‚â—„â”€â”€â”€â”€â–ºâ”‚ Records ğŸ“  â”‚â—„â”€â”€â”€â”€â–ºâ”‚ Records ğŸ“  â”‚ â”‚
â”‚   â”‚ (etcd copy) â”‚ sync â”‚ (etcd copy) â”‚ sync â”‚ (etcd copy) â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚   If Location A goes down â†’ B & C continue operating       â”‚
â”‚   99.95% uptime SLA guaranteed                             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Cost Considerations

| Component | Cost |
|-----------|------|
| **EKS Cluster** (Control Plane) | $0.10/hour (~$73/month) |
| **Worker Nodes** | Standard EC2 pricing (you choose instance type) |
| **Fargate** | Per vCPU + memory (~20% premium over EC2) |
| **Auto Mode** | Control plane + additional per-node fee |

**Cost Optimization Tips**:
- Use **Managed Node Groups** with **Spot Instances** for non-critical workloads
- Use **Karpenter** for intelligent right-sizing
- Use **Fargate** for bursty, unpredictable workloads

---

## Why Use a Managed Office (EKS) Instead of Building Your Own?

Without EKS, you would need to:
- Launch EC2 instances manually
- Install container runtime (containerd/Docker)
- Install and configure API Server, etcd, Controller Manager, Scheduler
- Set up networking (CNI plugins)
- Handle certificates and security
- Manage upgrades and patches yourself
- Ensure high availability

With EKS:
- âœ… Control plane is fully managed
- âœ… Automatic upgrades available
- âœ… Built-in high availability
- âœ… Integrated with AWS services (IAM, VPC, ELB, etc.)
- âœ… You focus on deploying applications

---

## Key Takeaways

1. **EKS = Managed Kubernetes** - AWS handles the hard parts of running K8s
2. **Standard Mode** - AWS manages control plane, you manage nodes
3. **Auto Mode** - AWS manages everything, you just deploy pods
4. **Control Plane is in AWS's VPC** - but ENIs are injected into your VPC for private communication
5. **Choose compute wisely** - Managed Node Groups for balance, Fargate for serverless, Karpenter for cost optimization
6. **Private endpoint = more secure** - traffic stays internal
7. **Cluster Security Group** - controls node â†” control plane communication
8. **HA is built-in** - multi-AZ API servers and etcd, 99.95% SLA

---

*Written on December 2, 2025*
