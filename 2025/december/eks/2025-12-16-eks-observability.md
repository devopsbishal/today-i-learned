# EKS Observability - The Building Operations Center

> Understanding EKS observability through metrics, logs, and traces using CloudWatch, Prometheus, X-Ray, and OpenTelemetry - continuing the office campus analogy.

---

## TL;DR

| EKS Observability Concept | Office Campus Analogy |
|--------------------------|----------------------|
| Three Pillars of Observability | Building Operations Center |
| Metrics | Building sensors (temperature, occupancy, power) |
| Logs | Activity reports & incident logs |
| Traces | Visitor badge tracking across departments |
| CloudWatch Container Insights | Main dashboard showing all floors/rooms |
| Prometheus | Custom sensor network (specialized measurements) |
| Metrics Server | Basic occupancy counter (simple head count) |
| FluentBit | Filing clerks collecting reports from departments |
| Control Plane Logs (Audit) | Security desk logs (who did what) |
| X-Ray / Distributed Tracing | Visitor tracking system (where did they go?) |
| Service Map | Building floor plan showing visitor flow |
| Trace ID | Visitor badge number (same ID everywhere) |
| OpenTelemetry (OTel) | Universal sensor format (works with any dashboard) |
| Grafana | Control room big screens with live dashboards |
| CloudWatch Alarms | Fire alarms, security alerts |

---

## The Observability Challenge

Your office campus (cluster) needs to answer critical questions:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              BUILDING OPERATIONS CENTER                     â”‚
â”‚                                                             â”‚
â”‚  ğŸ“Š "How's the building doing right now?"                  â”‚
â”‚     â””â”€â–º METRICS                                            â”‚
â”‚         CPU usage, memory, request rates, connections      â”‚
â”‚                                                             â”‚
â”‚  ğŸ“ "What happened? What went wrong?"                      â”‚
â”‚     â””â”€â–º LOGS                                               â”‚
â”‚         Error messages, access logs, audit trails          â”‚
â”‚                                                             â”‚
â”‚  ğŸ« "Where did this request go across services?"           â”‚
â”‚     â””â”€â–º TRACES                                             â”‚
â”‚         Request flow: Service A â†’ B â†’ C â†’ Response         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## The Three Pillars of Observability

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  PILLAR 1: METRICS (Building Sensors)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸŒ¡ï¸ Temperature: 72Â°F                              â”‚    â”‚
â”‚  â”‚  ğŸ‘¥ Occupancy: 85%                                 â”‚    â”‚
â”‚  â”‚  âš¡ Power: 450 kWh                                 â”‚    â”‚
â”‚  â”‚  ğŸ“Š Elevator wait time: 30 seconds                â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Numbers that tell you: "How is it RIGHT NOW?"    â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  EKS Examples:                                    â”‚    â”‚
â”‚  â”‚  â€¢ CPU: 75%                                       â”‚    â”‚
â”‚  â”‚  â€¢ Memory: 2.5 GB                                 â”‚    â”‚
â”‚  â”‚  â€¢ Requests/sec: 1500                             â”‚    â”‚
â”‚  â”‚  â€¢ Database connections: 45                       â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  PILLAR 2: LOGS (Activity Reports)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ“‹ 9:15 AM - Visitor John entered Floor 3        â”‚    â”‚
â”‚  â”‚  ğŸ“‹ 9:20 AM - Conference Room A booked            â”‚    â”‚
â”‚  â”‚  ğŸš¨ 9:25 AM - Fire door opened without badge!     â”‚    â”‚
â”‚  â”‚  ğŸ“‹ 9:30 AM - Elevator maintenance completed      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Text records that tell you: "WHAT HAPPENED?"     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  EKS Examples:                                    â”‚    â”‚
â”‚  â”‚  â€¢ ERROR: Connection to database failed           â”‚    â”‚
â”‚  â”‚  â€¢ INFO: User login successful                    â”‚    â”‚
â”‚  â”‚  â€¢ WARN: High memory usage detected               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  PILLAR 3: TRACES (Visitor Badge Tracking)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Badge #12345 Journey:                            â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ 9:00 Lobby â†’ 9:02 Floor 3 â†’ 9:10 Floor 5 â”‚     â”‚    â”‚
â”‚  â”‚  â”‚     â†“           â†“              â†“          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚   2 min       8 min          5 min        â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  (security)  (meeting)      (stuck!)      â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Flow records that tell you: "WHERE DID IT GO?"   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  EKS Examples:                                    â”‚    â”‚
â”‚  â”‚  â€¢ Request â†’ API Gateway â†’ Auth Service â†’         â”‚    â”‚
â”‚  â”‚    Order Service â†’ Database â†’ Response            â”‚    â”‚
â”‚  â”‚  â€¢ Total: 250ms (Database took 200ms - problem!) â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### When to Use Each Pillar

| Situation | Use | Example |
|-----------|-----|---------|
| "Is my app healthy?" | Metrics | CPU < 80%, error rate < 1% |
| "Why did this request fail?" | Logs | ERROR: NullPointerException at line 42 |
| "Why is checkout slow?" | Traces | Database query took 3 seconds |
| "Alert me if something breaks" | Metrics + Alarms | CPU > 90% â†’ send alert |

---

## CloudWatch Container Insights - The Main Dashboard

Container Insights is like the **main operations dashboard** showing status of all floors and rooms.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CLOUDWATCH CONTAINER INSIGHTS                     â”‚
â”‚                                                             â”‚
â”‚  What it monitors:                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ¢ CLUSTER LEVEL (Whole Campus)                  â”‚    â”‚
â”‚  â”‚     â€¢ Total CPU/Memory usage                      â”‚    â”‚
â”‚  â”‚     â€¢ Node count                                  â”‚    â”‚
â”‚  â”‚     â€¢ Running pod count                           â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ—ï¸ NODE LEVEL (Each Building)                    â”‚    â”‚
â”‚  â”‚     â€¢ Node CPU/Memory/Disk/Network                â”‚    â”‚
â”‚  â”‚     â€¢ Pods running per node                       â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ“¦ POD LEVEL (Each Room)                         â”‚    â”‚
â”‚  â”‚     â€¢ Pod CPU/Memory usage                        â”‚    â”‚
â”‚  â”‚     â€¢ Container restarts                          â”‚    â”‚
â”‚  â”‚     â€¢ Pod status                                  â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ³ CONTAINER LEVEL (Each Desk)                   â”‚    â”‚
â”‚  â”‚     â€¢ Container CPU/Memory                        â”‚    â”‚
â”‚  â”‚     â€¢ Container restart count                     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  âš ï¸  Container Insights = METRICS only                     â”‚
â”‚     For application LOGS, you need FluentBit!              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### How to Enable Container Insights

```bash
# Using EKS Add-on
aws eks create-addon \
  --cluster-name my-cluster \
  --addon-name amazon-cloudwatch-observability
```

### Container Insights Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Node 1                    Node 2                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ Pod A    Pod B   â”‚     â”‚ Pod C    Pod D   â”‚            â”‚
â”‚  â”‚                  â”‚     â”‚                  â”‚            â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚
â”‚  â”‚ â”‚ CloudWatch   â”‚ â”‚     â”‚ â”‚ CloudWatch   â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ Agent        â”‚ â”‚     â”‚ â”‚ Agent        â”‚ â”‚            â”‚
â”‚  â”‚ â”‚ (DaemonSet)  â”‚ â”‚     â”‚ â”‚ (DaemonSet)  â”‚ â”‚            â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚           â”‚                        â”‚                       â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                        â”‚                                   â”‚
â”‚                        â–¼                                   â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚           â”‚   CloudWatch Metrics   â”‚                      â”‚
â”‚           â”‚   (AWS/ContainerInsights)                     â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

CloudWatch Agent runs on every node (DaemonSet)
Collects metrics from kubelet, cAdvisor
Sends to CloudWatch every 60 seconds
```

---

## Prometheus & Metrics Server - Sensor Networks

### Metrics Server - Basic Occupancy Counter

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              METRICS SERVER (Basic Counter)                 â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸš¶ Building Entrance Counter                      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  "How many people in each room right now?"        â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Room A: 5 people (50% capacity)                  â”‚    â”‚
â”‚  â”‚  Room B: 8 people (80% capacity)                  â”‚    â”‚
â”‚  â”‚  Room C: 2 people (20% capacity)                  â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Simple measurements only:                        â”‚    â”‚
â”‚  â”‚  âœ… CPU usage                                     â”‚    â”‚
â”‚  â”‚  âœ… Memory usage                                  â”‚    â”‚
â”‚  â”‚  âŒ HTTP requests (no!)                           â”‚    â”‚
â”‚  â”‚  âŒ Custom metrics (no!)                          â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Primary Use: Feed data to HPA and VPA                     â”‚
â”‚  "Do we need more workers? Better equipment?"              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```bash
# What Metrics Server provides
kubectl top nodes
kubectl top pods

# Output:
NAME       CPU     MEMORY
node-1     45%     60%
pod-a      100m    256Mi
pod-b      200m    512Mi
```

### Prometheus - Custom Sensor Network

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PROMETHEUS (Custom Sensors)                    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ”¬ Advanced Building Sensor Network               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Measures ANYTHING you want:                      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  âœ… CPU/Memory (like Metrics Server)              â”‚    â”‚
â”‚  â”‚  âœ… HTTP requests per second                      â”‚    â”‚
â”‚  â”‚  âœ… Response time percentiles (p99, p95)          â”‚    â”‚
â”‚  â”‚  âœ… Database query duration                       â”‚    â”‚
â”‚  â”‚  âœ… Custom business metrics (orders/min)          â”‚    â”‚
â”‚  â”‚  âœ… Error rates                                   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Prometheus Pull Model

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  PULL MODEL (Prometheus)                                   â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                                   â”‚     â”‚
â”‚  â”‚  Prometheus Server                                â”‚     â”‚
â”‚  â”‚  "I'll come get metrics from you"                â”‚     â”‚
â”‚  â”‚           â”‚                                       â”‚     â”‚
â”‚  â”‚           â”‚ PULL (every 15s)                     â”‚     â”‚
â”‚  â”‚           â–¼                                       â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                        â”‚     â”‚
â”‚  â”‚  â”‚App Aâ”‚ â”‚App Bâ”‚ â”‚App Câ”‚ (expose /metrics)      â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜                        â”‚     â”‚
â”‚  â”‚                                                   â”‚     â”‚
â”‚  â”‚  âœ… Prometheus controls the pace                 â”‚     â”‚
â”‚  â”‚  âœ… Less chance of being overwhelmed             â”‚     â”‚
â”‚  â”‚  âœ… Knows when target is down (scrape fails)     â”‚     â”‚
â”‚  â”‚                                                   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â”‚  PUSH MODEL (Traditional)                                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                                                   â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”                        â”‚     â”‚
â”‚  â”‚  â”‚App Aâ”‚ â”‚App Bâ”‚ â”‚App Câ”‚                        â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜                        â”‚     â”‚
â”‚  â”‚     â”‚       â”‚       â”‚   PUSH (constantly)        â”‚     â”‚
â”‚  â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚     â”‚
â”‚  â”‚             â–¼                                     â”‚     â”‚
â”‚  â”‚     Monitoring Agent                             â”‚     â”‚
â”‚  â”‚     "Everyone sends to me!"                      â”‚     â”‚
â”‚  â”‚                                                   â”‚     â”‚
â”‚  â”‚  âš ï¸ Can be overwhelmed by many targets          â”‚     â”‚
â”‚  â”‚                                                   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AWS Managed Prometheus (AMP)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Self-Managed Prometheus        AWS Managed (AMP)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚                    â”‚        â”‚                    â”‚     â”‚
â”‚  â”‚ You manage:        â”‚        â”‚ AWS manages:       â”‚     â”‚
â”‚  â”‚ â€¢ Storage          â”‚        â”‚ â€¢ Storage          â”‚     â”‚
â”‚  â”‚ â€¢ High availabilityâ”‚   VS   â”‚ â€¢ High availabilityâ”‚     â”‚
â”‚  â”‚ â€¢ Scaling          â”‚        â”‚ â€¢ Scaling          â”‚     â”‚
â”‚  â”‚ â€¢ Upgrades         â”‚        â”‚ â€¢ Upgrades         â”‚     â”‚
â”‚  â”‚                    â”‚        â”‚                    â”‚     â”‚
â”‚  â”‚ ğŸ”§ More work       â”‚        â”‚ âœ… Less work       â”‚     â”‚
â”‚  â”‚ ğŸ’° Cheaper         â”‚        â”‚ ğŸ’° Pay per ingestionâ”‚     â”‚
â”‚  â”‚                    â”‚        â”‚                    â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Metrics Server vs Prometheus

| Aspect | Metrics Server | Prometheus |
|--------|---------------|------------|
| **Purpose** | Feed HPA/VPA | Full monitoring |
| **Metrics** | CPU, Memory only | Anything |
| **Storage** | No history | Long-term storage |
| **Querying** | `kubectl top` only | PromQL (powerful) |
| **Custom metrics** | âŒ No | âœ… Yes |
| **Complexity** | Simple | More complex |

---

## Logging - Activity Reports

### Kubernetes Logging Levels

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LOGGING LEVELS                           â”‚
â”‚                                                             â”‚
â”‚  NODE-LEVEL (Building's Filing Cabinet)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ“ Logs stored on the node itself               â”‚    â”‚
â”‚  â”‚     /var/log/containers/                          â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  âš ï¸ Problem: If node dies, logs die too!         â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Like keeping reports in each floor's cabinet    â”‚    â”‚
â”‚  â”‚  Floor destroyed = reports gone!                  â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  CLUSTER-LEVEL (Central Records Office)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ“ Logs sent to external storage                â”‚    â”‚
â”‚  â”‚     CloudWatch Logs, Elasticsearch, S3            â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  âœ… Survives node/pod failures                    â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Like central vault that stores all records      â”‚    â”‚
â”‚  â”‚  Building destroyed = records safe in vault!      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FluentBit - The Filing Clerks

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FLUENTBIT (Filing Clerks)                      â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Each node has a FluentBit agent (DaemonSet)      â”‚    â”‚
â”‚  â”‚  Like a filing clerk on each floor               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Node 1                 Node 2                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚ Pod A   Pod B   â”‚   â”‚ Pod C   Pod D   â”‚       â”‚    â”‚
â”‚  â”‚  â”‚   â”‚       â”‚     â”‚   â”‚   â”‚       â”‚     â”‚       â”‚    â”‚
â”‚  â”‚  â”‚   â–¼       â–¼     â”‚   â”‚   â–¼       â–¼     â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ â”‚ FluentBit â”‚   â”‚   â”‚ â”‚ FluentBit â”‚   â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ â”‚ (clerk)   â”‚   â”‚   â”‚ â”‚ (clerk)   â”‚   â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚   â”‚ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚          â”‚                     â”‚                  â”‚    â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚    â”‚
â”‚  â”‚                     â”‚                             â”‚    â”‚
â”‚  â”‚                     â–¼                             â”‚    â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚    â”‚
â”‚  â”‚          â”‚  CloudWatch Logs  â”‚                   â”‚    â”‚
â”‚  â”‚          â”‚  (Central Vault)  â”‚                   â”‚    â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  FluentBit:                                                â”‚
â”‚  â€¢ Collects logs from /var/log/containers/                 â”‚
â”‚  â€¢ Adds metadata (pod name, namespace, labels)             â”‚
â”‚  â€¢ Sends to CloudWatch, Elasticsearch, S3, etc.            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### EKS Control Plane Logs

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CONTROL PLANE LOGS (Security Desk)               â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ” API Server Logs                               â”‚    â”‚
â”‚  â”‚     All requests to Kubernetes API                â”‚    â”‚
â”‚  â”‚     "What API calls were made?"                   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ“ AUDIT Logs â­ Important!                      â”‚    â”‚
â”‚  â”‚     WHO did WHAT and WHEN                         â”‚    â”‚
â”‚  â”‚     "Who deleted that pod at 3 AM?"               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ”‘ Authenticator Logs                            â”‚    â”‚
â”‚  â”‚     Authentication attempts                        â”‚    â”‚
â”‚  â”‚     "Who tried to access the cluster?"            â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  âš™ï¸ Controller Manager Logs                       â”‚    â”‚
â”‚  â”‚     Deployment, ReplicaSet operations             â”‚    â”‚
â”‚  â”‚     "Why didn't my deployment scale?"             â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ“… Scheduler Logs                                â”‚    â”‚
â”‚  â”‚     Pod scheduling decisions                      â”‚    â”‚
â”‚  â”‚     "Why is my pod stuck pending?"                â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Enable in EKS Console or CLI:                             â”‚
â”‚  aws eks update-cluster-config \                           â”‚
â”‚    --name my-cluster \                                     â”‚
â”‚    --logging '{"clusterLogging":[{"types":["audit"]...}]}'â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Distributed Tracing - Visitor Badge Tracking

### The Problem Tracing Solves

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        THE PROBLEM: "WHY IS CHECKOUT SLOW?"                â”‚
â”‚                                                             â”‚
â”‚  User complains: "Checkout took 5 seconds!"                â”‚
â”‚                                                             â”‚
â”‚  WITHOUT TRACING:                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Frontend logs: "Checkout request received"        â”‚    â”‚
â”‚  â”‚  Cart logs: "Cart retrieved"                       â”‚    â”‚
â”‚  â”‚  Payment logs: "Payment processed"                 â”‚    â”‚
â”‚  â”‚  Order logs: "Order created"                       â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Which one was slow? No idea! ğŸ¤·                  â”‚    â”‚
â”‚  â”‚  Logs are separate, no connection between them    â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  WITH TRACING:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Trace ID: abc-123                                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚    â”‚
â”‚  â”‚  â”‚ Frontend    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ 50ms â”‚    â”‚
â”‚  â”‚  â”‚   â””â”€ Cart   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”‚ 100ms â”‚    â”‚
â”‚  â”‚  â”‚        â””â”€ Payment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ 4.5s! â”‚    â”‚
â”‚  â”‚  â”‚              â””â”€ Order â”€â”€â”€â”€            â”‚ 200ms â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  AHA! Payment service took 4.5 seconds! ğŸ¯       â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### How Tracing Works - The Badge System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            TRACE ID = VISITOR BADGE NUMBER                  â”‚
â”‚                                                             â”‚
â”‚  Request arrives â†’ Gets a badge (Trace ID: abc-123)        â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  LOBBY (API Gateway)                              â”‚    â”‚
â”‚  â”‚  Badge #abc-123 enters                            â”‚    â”‚
â”‚  â”‚  Span: "gateway" (50ms)                           â”‚    â”‚
â”‚  â”‚         â”‚                                          â”‚    â”‚
â”‚  â”‚         â”‚ passes badge to next department         â”‚    â”‚
â”‚  â”‚         â–¼                                          â”‚    â”‚
â”‚  â”‚  FLOOR 3 (Auth Service)                           â”‚    â”‚
â”‚  â”‚  Badge #abc-123 scanned                           â”‚    â”‚
â”‚  â”‚  Span: "auth" (20ms)                              â”‚    â”‚
â”‚  â”‚         â”‚                                          â”‚    â”‚
â”‚  â”‚         â”‚ passes badge to next department         â”‚    â”‚
â”‚  â”‚         â–¼                                          â”‚    â”‚
â”‚  â”‚  FLOOR 5 (Order Service)                          â”‚    â”‚
â”‚  â”‚  Badge #abc-123 scanned                           â”‚    â”‚
â”‚  â”‚  Span: "order" (100ms)                            â”‚    â”‚
â”‚  â”‚         â”‚                                          â”‚    â”‚
â”‚  â”‚         â”‚ passes badge to next department         â”‚    â”‚
â”‚  â”‚         â–¼                                          â”‚    â”‚
â”‚  â”‚  BASEMENT (Database)                              â”‚    â”‚
â”‚  â”‚  Badge #abc-123 scanned                           â”‚    â”‚
â”‚  â”‚  Span: "db-query" (500ms) â† SLOW!                â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Same badge (Trace ID) = Same request journey!            â”‚
â”‚  Each room visit = One Span                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AWS X-Ray - Service Map

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              X-RAY SERVICE MAP                              â”‚
â”‚                                                             â”‚
â”‚  Visual floor plan showing visitor flow                    â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚    â”‚
â”‚  â”‚        â”‚ Client  â”‚                                â”‚    â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                â”‚    â”‚
â”‚  â”‚             â”‚                                      â”‚    â”‚
â”‚  â”‚             â–¼                                      â”‚    â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    200 req/s                  â”‚    â”‚
â”‚  â”‚        â”‚ Gateway â”‚    5ms avg                     â”‚    â”‚
â”‚  â”‚        â”‚   âœ…    â”‚                                â”‚    â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                â”‚    â”‚
â”‚  â”‚             â”‚                                      â”‚    â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚    â”‚
â”‚  â”‚    â–¼        â–¼        â–¼                           â”‚    â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”                      â”‚    â”‚
â”‚  â”‚ â”‚Auth  â”‚ â”‚Order â”‚ â”‚Cart  â”‚                      â”‚    â”‚
â”‚  â”‚ â”‚ âœ…   â”‚ â”‚ âš ï¸   â”‚ â”‚ âœ…   â”‚                      â”‚    â”‚
â”‚  â”‚ â”‚ 5ms  â”‚ â”‚200ms â”‚ â”‚ 10ms â”‚                      â”‚    â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜                      â”‚    â”‚
â”‚  â”‚             â”‚                                      â”‚    â”‚
â”‚  â”‚             â–¼                                      â”‚    â”‚
â”‚  â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚    â”‚
â”‚  â”‚        â”‚Database â”‚                                â”‚    â”‚
â”‚  â”‚        â”‚   ğŸ”´    â”‚  â† 2s avg response!           â”‚    â”‚
â”‚  â”‚        â”‚   2s    â”‚                                â”‚    â”‚
â”‚  â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Service Map shows:                                        â”‚
â”‚  â€¢ Which services talk to which                           â”‚
â”‚  â€¢ Response times for each                                 â”‚
â”‚  â€¢ Error rates (green/yellow/red)                         â”‚
â”‚  â€¢ Request volume                                          â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## OpenTelemetry - Universal Sensor Format

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              OPENTELEMETRY (OTel)                           â”‚
â”‚                                                             â”‚
â”‚  Problem: Different backends need different formats        â”‚
â”‚                                                             â”‚
â”‚  WITHOUT OTEL:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Your App                                         â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚ X-Ray SDK     (for AWS X-Ray)          â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ Prometheus SDK (for Prometheus)         â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ Jaeger SDK    (for Jaeger)             â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ DataDog SDK   (for DataDog)            â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ˜© Different SDK for each backend!               â”‚    â”‚
â”‚  â”‚     Vendor lock-in!                               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  WITH OTEL:                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Your App                                         â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚ OpenTelemetry SDK (one standard!)      â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                      â”‚                             â”‚    â”‚
â”‚  â”‚                      â–¼                             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚ OTel Collector                         â”‚       â”‚    â”‚
â”‚  â”‚  â”‚ (converts to any format)               â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚    â”‚
â”‚  â”‚          â–¼           â–¼           â–¼                â”‚    â”‚
â”‚  â”‚      X-Ray     Prometheus    Jaeger               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  âœ… One SDK, many backends!                       â”‚    â”‚
â”‚  â”‚     No vendor lock-in!                            â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AWS Distro for OpenTelemetry (ADOT)

```
ADOT = AWS's distribution of OpenTelemetry

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Your EKS Pods                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ App with OTel SDK                               â”‚       â”‚
â”‚  â”‚ (instruments code automatically)                â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                           â”‚                                 â”‚
â”‚                           â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ ADOT Collector (runs as sidecar or DaemonSet)   â”‚       â”‚
â”‚  â”‚ â€¢ Receives traces, metrics, logs                â”‚       â”‚
â”‚  â”‚ â€¢ Processes and batches                         â”‚       â”‚
â”‚  â”‚ â€¢ Exports to AWS services                       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚          â–¼                â–¼                â–¼               â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚    â”‚ X-Ray    â”‚    â”‚ CloudWatchâ”‚    â”‚ AMP       â”‚         â”‚
â”‚    â”‚ (traces) â”‚    â”‚ (logs)    â”‚    â”‚(Prometheus)â”‚         â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## The Complete Picture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EKS OBSERVABILITY ARCHITECTURE                     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      YOUR PODS                            â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚ â”‚
â”‚  â”‚  â”‚ App A   â”‚ â”‚ App B   â”‚ â”‚ App C   â”‚                     â”‚ â”‚
â”‚  â”‚  â”‚ (OTel)  â”‚ â”‚ (OTel)  â”‚ â”‚ (OTel)  â”‚                     â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚           â”‚           â”‚                              â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                      â”‚                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   â–¼              COLLECTORS               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚
â”‚  â”‚  â”‚ FluentBit â”‚ CloudWatch Agent â”‚ ADOT Collector        â”‚â”‚ â”‚
â”‚  â”‚  â”‚  (logs)   â”‚    (metrics)     â”‚ (traces/metrics)      â”‚â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚              â”‚                     â”‚                â”‚
â”‚           â–¼              â–¼                     â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚                    AWS SERVICES                             â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  â”‚ CloudWatch  â”‚ â”‚   X-Ray     â”‚ â”‚     AMP     â”‚           â”‚
â”‚  â”‚  â”‚   Logs      â”‚ â”‚  (traces)   â”‚ â”‚ (Prometheus)â”‚           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”‚         â”‚               â”‚               â”‚                   â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚  â”‚                         â”‚                                   â”‚
â”‚  â”‚                         â–¼                                   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  â”‚              GRAFANA (Dashboards)               â”‚       â”‚
â”‚  â”‚  â”‚                                                 â”‚       â”‚
â”‚  â”‚  â”‚  ğŸ“Š Metrics  â”‚  ğŸ“ Logs  â”‚  ğŸ” Traces          â”‚       â”‚
â”‚  â”‚  â”‚    charts   â”‚   search  â”‚   flame graphs       â”‚       â”‚
â”‚  â”‚  â”‚                                                 â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”‚                         â”‚                                   â”‚
â”‚  â”‚                         â–¼                                   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  â”‚           CLOUDWATCH ALARMS                     â”‚       â”‚
â”‚  â”‚  â”‚                                                 â”‚       â”‚
â”‚  â”‚  â”‚  ğŸš¨ CPU > 90%? â†’ SNS â†’ PagerDuty â†’ On-call     â”‚       â”‚
â”‚  â”‚  â”‚  ğŸš¨ Error rate > 5%? â†’ SNS â†’ Slack notification â”‚       â”‚
â”‚  â”‚  â”‚                                                 â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Which Metrics Tool for What?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  "What's the ELB request count?"                           â”‚
â”‚  â””â”€â–º CloudWatch (Native) âœ…                                â”‚
â”‚      AWS services send metrics here automatically          â”‚
â”‚                                                             â”‚
â”‚  "What's the pod CPU usage?"                               â”‚
â”‚  â””â”€â–º Container Insights âœ… OR Prometheus âœ…                â”‚
â”‚      Both can do this                                       â”‚
â”‚                                                             â”‚
â”‚  "What's my app's HTTP requests/second?"                   â”‚
â”‚  â””â”€â–º Prometheus âœ…                                         â”‚
â”‚      Custom application metrics                             â”‚
â”‚                                                             â”‚
â”‚  "Do I need to scale my pods?" (HPA)                       â”‚
â”‚  â””â”€â–º Metrics Server âœ…                                     â”‚
â”‚      HPA uses this for decisions                           â”‚
â”‚                                                             â”‚
â”‚  "Where did this request slow down?"                       â”‚
â”‚  â””â”€â–º X-Ray / Distributed Tracing âœ…                        â”‚
â”‚      Follow request across services                         â”‚
â”‚                                                             â”‚
â”‚  "Who deleted that pod?"                                   â”‚
â”‚  â””â”€â–º Control Plane Logs (Audit) âœ…                         â”‚
â”‚      Security desk records                                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## FluentBit Deep Dive - The Filing Clerk's Workflow

FluentBit is a lightweight log processor that collects, processes, and forwards logs.

### Why DaemonSet?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           WHY FLUENTBIT RUNS AS DAEMONSET                   â”‚
â”‚                                                             â”‚
â”‚  âŒ DEPLOYMENT (Wrong approach)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Node 1        Node 2        Node 3               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”             â”‚    â”‚
â”‚  â”‚  â”‚ FB  â”‚       â”‚ FB  â”‚       â”‚     â”‚ â† No agent! â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Problems:                                        â”‚    â”‚
â”‚  â”‚  â€¢ Node 3 has no log collector!                   â”‚    â”‚
â”‚  â”‚  â€¢ Need to manually set replicas = node count    â”‚    â”‚
â”‚  â”‚  â€¢ New nodes won't get FluentBit automatically   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  âœ… DAEMONSET (Correct approach)                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Node 1        Node 2        Node 3               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”             â”‚    â”‚
â”‚  â”‚  â”‚ FB  â”‚       â”‚ FB  â”‚       â”‚ FB  â”‚             â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”˜             â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Benefits:                                        â”‚    â”‚
â”‚  â”‚  âœ… One pod per node automatically               â”‚    â”‚
â”‚  â”‚  âœ… New nodes get FluentBit automatically        â”‚    â”‚
â”‚  â”‚  âœ… Access to node's /var/log/containers/        â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FluentBit Pipeline: Input â†’ Filter â†’ Output

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FLUENTBIT PIPELINE                             â”‚
â”‚                                                             â”‚
â”‚  Like a filing clerk's workflow:                           â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  INPUT (Collect Reports)                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ“¥ "Where do I get the logs from?"       â”‚     â”‚    â”‚
â”‚  â”‚  â”‚                                          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ tail: Read log files                  â”‚     â”‚    â”‚
â”‚  â”‚  â”‚    /var/log/containers/*.log             â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ systemd: Read systemd journal         â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ tcp/udp: Receive over network         â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                          â”‚                         â”‚    â”‚
â”‚  â”‚                          â–¼                         â”‚    â”‚
â”‚  â”‚  FILTER (Process & Enrich)                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ”§ "How do I process these logs?"        â”‚     â”‚    â”‚
â”‚  â”‚  â”‚                                          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ kubernetes: Add pod name, namespace,  â”‚     â”‚    â”‚
â”‚  â”‚  â”‚    labels from K8s API                   â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ parser: Parse JSON/regex              â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ modify: Add/remove fields             â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ grep: Include/exclude patterns        â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                          â”‚                         â”‚    â”‚
â”‚  â”‚                          â–¼                         â”‚    â”‚
â”‚  â”‚  OUTPUT (Send to Backend)                         â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚  ğŸ“¤ "Where do I send the logs?"           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚                                          â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ cloudwatch_logs: AWS CloudWatch       â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ es: Elasticsearch                     â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ s3: AWS S3 bucket                     â”‚     â”‚    â”‚
â”‚  â”‚  â”‚  â€¢ kafka: Kafka topic                    â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### FluentBit Configuration Example

```ini
# fluent-bit.conf (INI/classic format -- FluentBit also supports YAML config)
[SERVICE]
    Flush         5
    Log_Level     info

[INPUT]
    Name              tail
    Path              /var/log/containers/*.log
    Tag               kube.*
    Refresh_Interval  10

[FILTER]
    Name                kubernetes
    Match               kube.*
    Kube_URL            https://kubernetes.default.svc:443
    Kube_CA_File        /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
    Kube_Token_File     /var/run/secrets/kubernetes.io/serviceaccount/token
    Merge_Log           On
    K8S-Logging.Parser  On

[OUTPUT]
    Name                cloudwatch_logs
    Match               *
    region              us-west-2
    log_group_name      /aws/eks/my-cluster/containers
    log_stream_prefix   fluentbit-
    auto_create_group   true
```

### Where Does FluentBit Get Kubernetes Metadata?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Raw log: "ERROR: Connection timeout"                      â”‚
â”‚                    â”‚                                        â”‚
â”‚                    â–¼                                        â”‚
â”‚  FluentBit queries Kubernetes API Server                   â”‚
â”‚  "What pod wrote to this log file?"                        â”‚
â”‚                    â”‚                                        â”‚
â”‚                    â–¼                                        â”‚
â”‚  Enriched log:                                             â”‚
â”‚  {                                                         â”‚
â”‚    "message": "ERROR: Connection timeout",                 â”‚
â”‚    "kubernetes": {                                         â”‚
â”‚      "pod_name": "api-server-7d8b9c",                     â”‚
â”‚      "namespace": "production",                           â”‚
â”‚      "container_name": "api",                             â”‚
â”‚      "labels": {                                          â”‚
â”‚        "app": "api-server",                               â”‚
â”‚        "version": "v2.1.0"                                â”‚
â”‚      }                                                     â”‚
â”‚    }                                                       â”‚
â”‚  }                                                         â”‚
â”‚                                                             â”‚
â”‚  Now you can search: "Show all ERROR logs from production" â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Grafana - The Control Room Dashboards

Grafana is a **visualization tool** that displays data from multiple sources on beautiful dashboards.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GRAFANA (Control Room)                         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚   ğŸ–¥ï¸ Big Screens in the Operations Center          â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚   â”‚ CPU Usage   â”‚ Request/s   â”‚ Error Rate  â”‚     â”‚    â”‚
â”‚  â”‚   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”   â”‚     â”‚    â”‚
â”‚  â”‚   â”‚ â”‚ ğŸ“ˆ    â”‚   â”‚ â”‚ ğŸ“Š    â”‚   â”‚ â”‚ ğŸ“‰    â”‚   â”‚     â”‚    â”‚
â”‚  â”‚   â”‚ â”‚  75%  â”‚   â”‚ â”‚ 1.5K  â”‚   â”‚ â”‚ 0.5%  â”‚   â”‚     â”‚    â”‚
â”‚  â”‚   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚     â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚   â”‚ Recent Logs                             â”‚     â”‚    â”‚
â”‚  â”‚   â”‚ ERROR: Connection to DB failed          â”‚     â”‚    â”‚
â”‚  â”‚   â”‚ WARN: High memory usage on pod-xyz      â”‚     â”‚    â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Grafana itself doesn't store data!                        â”‚
â”‚  It QUERIES data from backends (data sources)              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Grafana Data Sources

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GRAFANA DATA SOURCES                           â”‚
â”‚                                                             â”‚
â”‚  Grafana can query MULTIPLE backends in ONE dashboard:     â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚    â”‚
â”‚  â”‚           â”‚    GRAFANA      â”‚                     â”‚    â”‚
â”‚  â”‚           â”‚   Dashboard     â”‚                     â”‚    â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚    â”‚
â”‚  â”‚                    â”‚                               â”‚    â”‚
â”‚  â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚    â”‚
â”‚  â”‚     â”‚              â”‚              â”‚               â”‚    â”‚
â”‚  â”‚     â–¼              â–¼              â–¼               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚  â”‚Prome-â”‚     â”‚CloudWatchâ”‚    â”‚ X-Ray â”‚          â”‚    â”‚
â”‚  â”‚  â”‚theus â”‚     â”‚  Logs    â”‚    â”‚Traces â”‚          â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â”‚  Metrics       Logs           Traces              â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  One dashboard showing ALL three pillars! âœ…      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Popular data sources:                                     â”‚
â”‚  â€¢ Prometheus / AMP (metrics)                              â”‚
â”‚  â€¢ CloudWatch Logs (logs)                                  â”‚
â”‚  â€¢ Elasticsearch / OpenSearch (logs)                       â”‚
â”‚  â€¢ X-Ray (traces)                                          â”‚
â”‚  â€¢ MySQL, PostgreSQL (application data)                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### How Queries Work

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           WHERE IS THE QUERY EXECUTED?                      â”‚
â”‚                                                             â”‚
â”‚  User views Grafana dashboard                              â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  Grafana sends query to Prometheus                         â”‚
â”‚  "Give me HTTP requests per second for last 1 hour"        â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  Prometheus executes PromQL query                          â”‚
â”‚  rate(http_requests_total[5m])                             â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  Prometheus returns data to Grafana                        â”‚
â”‚  [{time: 10:00, value: 150}, {time: 10:01, value: 155}...] â”‚
â”‚         â”‚                                                   â”‚
â”‚         â–¼                                                   â”‚
â”‚  Grafana renders the chart                                 â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ Grafana = Display layer                                â”‚
â”‚     Backend = Computation layer                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### AWS Managed Grafana (AMG) vs Self-Hosted

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Self-Managed Grafana          AWS Managed (AMG)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                    â”‚       â”‚                    â”‚      â”‚
â”‚  â”‚ You manage:        â”‚       â”‚ AWS manages:       â”‚      â”‚
â”‚  â”‚ â€¢ EC2/EKS hosting  â”‚       â”‚ â€¢ Infrastructure   â”‚      â”‚
â”‚  â”‚ â€¢ High availabilityâ”‚  VS   â”‚ â€¢ High availabilityâ”‚      â”‚
â”‚  â”‚ â€¢ Upgrades         â”‚       â”‚ â€¢ Upgrades         â”‚      â”‚
â”‚  â”‚ â€¢ Security patches â”‚       â”‚ â€¢ Security patches â”‚      â”‚
â”‚  â”‚ â€¢ Backups          â”‚       â”‚ â€¢ Backups          â”‚      â”‚
â”‚  â”‚                    â”‚       â”‚                    â”‚      â”‚
â”‚  â”‚ âœ… Full control    â”‚       â”‚ âœ… Less work       â”‚      â”‚
â”‚  â”‚ âœ… No license cost â”‚       â”‚ âœ… AWS IAM login   â”‚      â”‚
â”‚  â”‚ ğŸ”§ More work       â”‚       â”‚ ğŸ’° Pay per user    â”‚      â”‚
â”‚  â”‚                    â”‚       â”‚                    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                             â”‚
â”‚  Both can connect to AWS services (CloudWatch, AMP, X-Ray) â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## CloudWatch Alarms - The Alert System

CloudWatch Alarms notify you when metrics cross thresholds - like fire alarms or security alerts.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CLOUDWATCH ALARMS (Alert System)               â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚   ğŸš¨ Building Alert System                         â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚   Temperature > 85Â°F?  â†’ ğŸ”” HVAC Alert            â”‚    â”‚
â”‚  â”‚   Occupancy > 90%?     â†’ ğŸ”” Capacity Alert        â”‚    â”‚
â”‚  â”‚   Power usage > 500kW? â†’ ğŸ”” Energy Alert          â”‚    â”‚
â”‚  â”‚   Fire detected?       â†’ ğŸ””ğŸ””ğŸ”” EVACUATE!         â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚   EKS Examples:                                   â”‚    â”‚
â”‚  â”‚   CPU > 80%?           â†’ ğŸ”” Scale up alert        â”‚    â”‚
â”‚  â”‚   Error rate > 5%?     â†’ ğŸ”” On-call page          â”‚    â”‚
â”‚  â”‚   Pod restarts > 3?    â†’ ğŸ”” Investigate           â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Alarm States

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              THREE ALARM STATES                             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  âœ… OK                                             â”‚    â”‚
â”‚  â”‚     Metric is within threshold                    â”‚    â”‚
â”‚  â”‚     "Everything is fine, CPU at 45%"              â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ”´ ALARM                                          â”‚    â”‚
â”‚  â”‚     Metric breached threshold                     â”‚    â”‚
â”‚  â”‚     "CPU at 92%! Above 80% threshold!"            â”‚    â”‚
â”‚  â”‚     â†’ Triggers notification actions               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  âšª INSUFFICIENT_DATA                              â”‚    â”‚
â”‚  â”‚     Not enough data to evaluate                   â”‚    â”‚
â”‚  â”‚     "Alarm just created, waiting for data"        â”‚    â”‚
â”‚  â”‚     "Metric stopped reporting"                    â”‚    â”‚
â”‚  â”‚     "Not enough data points yet"                  â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  State transitions:                                        â”‚
â”‚  OK â†’ ALARM (threshold breached)                           â”‚
â”‚  ALARM â†’ OK (recovered)                                    â”‚
â”‚  INSUFFICIENT_DATA â†’ OK/ALARM (data arrives)               â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Alarm Configuration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           CONFIGURING "CPU > 80% FOR 5 MINUTES"            â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Threshold:          80%                          â”‚    â”‚
â”‚  â”‚                      â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€        â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Period:             1 minute                     â”‚    â”‚
â”‚  â”‚  (How often to check)                             â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Evaluation Periods: 5                            â”‚    â”‚
â”‚  â”‚  (Look at last 5 periods)                         â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Datapoints to Alarm: 5 out of 5                 â”‚    â”‚
â”‚  â”‚  (All 5 must breach)                              â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Timeline:                                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                      â”‚    â”‚
â”‚  â”‚  â”‚ 85%â”‚ 82%â”‚ 78%â”‚ 88%â”‚ 91%â”‚ â†’ NOT ALARM         â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜   (only 4/5 above)  â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”                      â”‚    â”‚
â”‚  â”‚  â”‚ 85%â”‚ 82%â”‚ 83%â”‚ 88%â”‚ 91%â”‚ â†’ ALARM! ğŸ”´         â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜   (5/5 above 80%)   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  This prevents alerts from brief spikes!                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Alarm Actions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              WHAT HAPPENS WHEN ALARM TRIGGERS?             â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ALARM: CPU > 80%                                 â”‚    â”‚
â”‚  â”‚         â”‚                                          â”‚    â”‚
â”‚  â”‚         â–¼                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ SNS Topic                                â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚    â”‚
â”‚  â”‚          â–¼         â–¼         â–¼                    â”‚    â”‚
â”‚  â”‚       ğŸ“§ Email  ğŸ“± SMS   ğŸ’¬ Slack                 â”‚    â”‚
â”‚  â”‚       (devops@) (on-call) (alerts channel)        â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  OR trigger automated actions:                    â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  â€¢ Auto Scaling: Add more instances               â”‚    â”‚
â”‚  â”‚  â€¢ Lambda: Run custom remediation                 â”‚    â”‚
â”‚  â”‚  â€¢ Systems Manager: Execute runbook               â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Composite Alarms

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COMPOSITE ALARMS                               â”‚
â”‚                                                             â”‚
â”‚  Problem: Too many alerts! Alert fatigue!                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Regular Alarms (noisy):                          â”‚    â”‚
â”‚  â”‚  ğŸ”´ CPU > 80%    â†’ Alert!                         â”‚    â”‚
â”‚  â”‚  ğŸ”´ Memory > 85% â†’ Alert!                         â”‚    â”‚
â”‚  â”‚  ğŸ”´ Disk > 90%   â†’ Alert!                         â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  3 separate alerts for maybe 1 real problem!      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Composite Alarm (smarter):                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Alert only if:                                   â”‚    â”‚
â”‚  â”‚  (CPU > 80% AND Memory > 85%)                     â”‚    â”‚
â”‚  â”‚  OR                                               â”‚    â”‚
â”‚  â”‚  (Disk > 90%)                                     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Uses AND/OR logic to reduce false positives!     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Use cases:                                       â”‚    â”‚
â”‚  â”‚  â€¢ Alert if BOTH CPU and Memory are high         â”‚    â”‚
â”‚  â”‚  â€¢ Alert if ANY of 3 critical services are down  â”‚    â”‚
â”‚  â”‚  â€¢ Multi-region: Alert if BOTH regions have issuesâ”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Alarm Example (AWS CLI)

```bash
# Create alarm for CPU > 80% for 5 minutes
aws cloudwatch put-metric-alarm \
  --alarm-name "HighCPU-Production" \
  --metric-name CPUUtilization \
  --namespace AWS/EC2 \
  --statistic Average \
  --period 60 \
  --threshold 80 \
  --comparison-operator GreaterThanThreshold \
  --evaluation-periods 5 \
  --datapoints-to-alarm 5 \
  --alarm-actions arn:aws:sns:us-west-2:123456789:alerts-topic
```

---

## Quick Reference

| Component | Type | Purpose | AWS Managed Option |
|-----------|------|---------|-------------------|
| Container Insights | Metrics | K8s cluster/pod metrics | âœ… Built-in |
| Metrics Server | Metrics | Basic CPU/Memory for HPA | Install separately |
| Prometheus | Metrics | Custom app metrics | AMP |
| FluentBit | Logs | Collect & ship logs | âœ… Part of CloudWatch |
| Control Plane Logs | Logs | API/Audit/Auth logs | âœ… Built-in EKS |
| X-Ray | Traces | Distributed tracing | âœ… Built-in |
| OpenTelemetry | All three | Vendor-neutral collection | ADOT |
| Grafana | Visualization | Dashboards | AMG |
| CloudWatch Alarms | Alerting | Threshold alerts | âœ… Built-in |

---

## Common Pitfalls

| Problem | Solution |
|---------|----------|
| **App logs not in CloudWatch** | Install FluentBit DaemonSet |
| **Don't know who changed what** | Enable Control Plane audit logs |
| **Can't debug slow requests** | Enable X-Ray tracing |
| **HPA not working** | Install Metrics Server |
| **Too many metrics backends** | Use OpenTelemetry (ADOT) |
| **No alerts** | Set up CloudWatch Alarms |
| **Too many alerts (noise)** | Use Composite Alarms with AND/OR logic |
| **Logs missing K8s metadata** | Check FluentBit kubernetes filter config |
| **Grafana shows no data** | Verify data source connection and query |

---

## Key Takeaways

1. **Three Pillars**: Metrics (how much?), Logs (what happened?), Traces (where did it go?)
2. **Container Insights = Dashboard** - Kubernetes metrics, not app logs
3. **FluentBit = Filing clerks** - DaemonSet, Inputâ†’Filterâ†’Output pipeline, queries K8s API for metadata
4. **Prometheus = Custom sensors** - Pull model, application metrics
5. **Metrics Server = Basic counter** - Feeds HPA/VPA, CPU/Memory only
6. **X-Ray = Visitor tracking** - Trace ID follows request across services
7. **OpenTelemetry = Universal format** - No vendor lock-in
8. **Grafana = Control room screens** - Visualization layer, queries data sources
9. **CloudWatch Alarms = Alert system** - Three states (OK, ALARM, INSUFFICIENT_DATA), composite alarms for smarter alerts
10. **Audit logs = Security desk** - Who did what in the cluster

---

## Related Reading

- [AWS VPC - The Compound Analogy](../november/2025-11-30-aws-vpc.md)
- [AWS EKS - The Managed Office Building Analogy](./2025-12-02-aws-eks.md)
- [AWS VPC CNI - The Phone Extension System](./2025-12-03-aws-vpc-cni.md)
- [EKS Networking - The Mail & Delivery System](./2025-12-09-eks-networking.md)
- [EKS IAM - The Employee Badge System](./2025-12-10-eks-iam-irsa-pod-identity.md)
- [EKS Storage - The Locker & Storage Room System](./2025-12-11-eks-storage.md)
- [EKS Autoscaling - The Staffing & Workspace Management](./2025-12-12-eks-autoscaling.md)
- [EKS Security - The Corporate Security System](./2025-12-14-eks-security.md)

---

*Written on December 16, 2025*
