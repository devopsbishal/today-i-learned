# AWS EKS - The Managed Office Building Analogy

> Understanding Amazon EKS as a managed office campus where building management handles infrastructure, and you focus on your work.

---

## TL;DR

| AWS EKS Concept | Managed Office Analogy |
|-----------------|------------------------|
| EKS | Managed office campus (like WeWork) |
| Control Plane | Campus management (reception, security, utilities) |
| Data Plane (VPC) | Your office campus (with multiple buildings) |
| Subnets | Buildings in your campus |
| Standard Mode | Standard plan - campus ready, you set up rooms |
| Auto Mode | Full-service plan - everything provided, just work |
| API Server | Reception desk (handles all requests) |
| etcd | Filing cabinets (stores all records) |
| Scheduler | Room assignment manager |
| Controller Manager | Campus supervisors |
| Worker Nodes | Rooms inside buildings |
| Pods | Desks inside rooms (where work happens) |
| kubelet | Room manager (reports to campus management) |
| Cluster Security Group | Campus communication protocol |
| Private Endpoint | Internal intercom system |
| Public Endpoint | Public phone number |
| ENIs | Phone panels in each room |

---

## The Big Picture

Imagine you want to run a business. You have two options:

**Option 1: Build Your Own Office Campus**
Buy land, construct buildings, install electricity, plumbing, security systems, hire maintenance staff... everything is on you.

**Option 2: Use a Managed Office Campus (EKS)**
Partner with a campus management company. They provide a fully operational campus with buildings - you just set up your rooms and focus on work.

---

## The Setup

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CAMPUS MANAGEMENT (AWS Managed VPC)                â”‚
â”‚                                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚              CAMPUS OPERATIONS                          â”‚ â”‚
â”‚    â”‚                (Control Plane)                          â”‚ â”‚
â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚   ğŸ“‹ Reception Desk (API Server) - handles all requestsâ”‚ â”‚
â”‚    â”‚   ğŸ—„ï¸ Filing Cabinets (etcd) - stores all records       â”‚ â”‚
â”‚    â”‚   ğŸ“… Room Assignment (Scheduler) - assigns workspace   â”‚ â”‚
â”‚    â”‚   ğŸ‘” Supervisors (Controllers) - ensure things run     â”‚ â”‚
â”‚    â”‚                                                         â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                   â˜ï¸ Internal Intercom (ENIs)
                   (installed in YOUR buildings)
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     YOUR OFFICE CAMPUS                          â”‚
â”‚                        (Your VPC)                               â”‚
â”‚                           â”‚                                     â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚    â”‚              BUILDING A (Subnet 1)                      â”‚ â”‚
â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚   ğŸšª Room 1 (Node 1)        ğŸšª Room 2 (Node 2)          â”‚ â”‚
â”‚    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â”‚
â”‚    â”‚   â”‚ Desk 1 (Pod)    â”‚       â”‚ Desk 4 (Pod)    â”‚        â”‚ â”‚
â”‚    â”‚   â”‚ Desk 2 (Pod)    â”‚       â”‚ Desk 5 (Pod)    â”‚        â”‚ â”‚
â”‚    â”‚   â”‚ Desk 3 (Pod)    â”‚       â”‚ Desk 6 (Pod)    â”‚        â”‚ â”‚
â”‚    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â”‚
â”‚    â”‚                                                         â”‚ â”‚
â”‚    â”‚   Each room has a Room Manager (kubelet)               â”‚ â”‚
â”‚    â”‚   who reports to Campus Management                     â”‚ â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## EKS Standard vs Auto Mode

The building offers two plans:

### Standard Plan (EKS Standard)

Building management provides:
- âœ… The building (Control Plane)
- âœ… Reception, security, utilities
- âœ… Communication systems

You handle:
- ğŸ‘· Hiring your team (provisioning nodes)
- ğŸ“‹ Managing your team (node lifecycle)
- ğŸ’° Paying your staff (EC2 costs)

### Full-Service Plan (EKS Auto Mode)

Building management provides:
- âœ… Everything in Standard, PLUS
- âœ… Staff provided for you (nodes managed by AWS)
- âœ… Automatic scaling of workforce

You only:
- ğŸ¯ Define what work needs to be done (deploy pods)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      STANDARD PLAN          â”‚   â”‚     FULL-SERVICE PLAN       â”‚
â”‚                             â”‚   â”‚                             â”‚
â”‚  Building: âœ… Managed       â”‚   â”‚  Building: âœ… Managed       â”‚
â”‚  Your Team: ğŸ‘· You hire     â”‚   â”‚  Your Team: âœ… Provided     â”‚
â”‚  Your Work: ğŸ¯ You do       â”‚   â”‚  Your Work: ğŸ¯ You do       â”‚
â”‚                             â”‚   â”‚                             â”‚
â”‚  More control               â”‚   â”‚  Less hassle                â”‚
â”‚  More responsibility        â”‚   â”‚  More cost                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Compute Options - How to Set Up Rooms in Your Campus

In the Standard Plan, you need to set up rooms and desks. Different strategies:

| Hiring Strategy | EKS Option | How It Works |
|-----------------|------------|--------------|
| **Staffing Agency** | Managed Node Groups | Tell agency "I need 5 developers". They hire, handle HR/payroll, manage lifecycle. You just supervise work. |
| **Contract Workers** | Fargate | No permanent hires. Workers appear when there's work, bill hourly, leave when done. Fully serverless. |
| **Smart Recruiter** | Karpenter | Hire a recruiter who watches workload in real-time. Hires when busy, lets go when slow. Great for cost optimization. |
| **Direct Hiring** | Self-Managed Nodes | You personally interview, hire, train, manage, fire. Full control, full responsibility. |
| **Remote Workers** | Hybrid Nodes | Staff working from another location (on-premises data center) but connected to your floor. |

### Choosing the Right Option

```
More AWS Control â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º More Your Control
     
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Auto    â”‚  Fargate â”‚  Managed  â”‚ Karpenter â”‚ Self-Managed â”‚
â”‚  Mode    â”‚          â”‚  Node Grp â”‚           â”‚  Nodes       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚          â”‚           â”‚           â”‚            â”‚
     â–¼          â–¼           â–¼           â–¼            â–¼
  Easiest   Serverless   Balanced   Smart Auto   Full Control
```

---

## Communication - How Your Campus Talks to Campus Management

### The Challenge

Campus Management operates from a **separate facility** (AWS Managed VPC). Your campus with buildings is in **your property** (Your VPC). How do they communicate?

### Private Intercom (Private Endpoint)

Campus Management installs an **internal intercom system** directly in your buildings:

- Has a **local extension number** (Private IP in your VPC)
- Connected through **internal campus wiring** (AWS backbone)
- Never goes through public phone lines
- This intercom = **ENIs created in your VPC**

### Public Phone Line (Public Endpoint)

Building Management also has a **public phone number**:
- Anyone can call (with proper credentials)
- Goes through public phone networks (internet)
- Less secure but accessible from anywhere

### Three Access Modes

| Mode | Analogy | When to Use |
|------|---------|-------------|
| **Public Only** | Only public phone number. Your room managers and you call HQ on public line. | Simple setup, quick start |
| **Private Only** | Only internal intercom. Must be inside campus to communicate. | Maximum security, need VPN for remote access |
| **Both Enabled** | Public phone + internal intercom. Room managers use intercom (faster). You can call from outside. | Best of both worlds |

```
PUBLIC ONLY:
  You (anywhere) â”€â”€â”€â–º Public Phone â”€â”€â”€â–º Campus Management âœ…
  Room Manager â”€â”€â”€â–º Public Phone â”€â”€â”€â–º Campus Management âœ…

PRIVATE ONLY:
  You (inside) â”€â”€â”€â–º Intercom â”€â”€â”€â–º Campus Management âœ…
  You (outside) â”€â”€â”€â–º âŒ Can't reach
  Room Manager â”€â”€â”€â–º Intercom â”€â”€â”€â–º Campus Management âœ…

BOTH ENABLED:
  You (outside) â”€â”€â”€â–º Public Phone â”€â”€â”€â–º Campus Management âœ…
  Room Manager â”€â”€â”€â–º Intercom â”€â”€â”€â–º Campus Management âœ… (preferred)
```

---

## Security - Campus Communication Protocol

### Cluster Security Group

The campus has a **Communication Protocol** that defines who can talk to whom:

| Communication | Port | Purpose |
|---------------|------|---------|
| Room Manager â†’ Campus Mgmt | 443 | Report status, get instructions |
| Campus Mgmt â†’ Room Manager | 10250 | Check on desks, direct commands |
| Room Manager â†” Room Manager | All | Cross-building coordination |

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COMMUNICATION PROTOCOL                     â”‚
â”‚              (Cluster Security Group)                   â”‚
â”‚                                                         â”‚
â”‚   âœ… Allowed:                                           â”‚
â”‚   ğŸ“ Room Manager â†’ HQ (port 443): Status reports      â”‚
â”‚   ğŸ“ HQ â†’ Room Manager (port 10250): kubectl exec/logs â”‚
â”‚   ğŸ“ Room Manager â†” Room Manager: Cross-building comm  â”‚
â”‚                                                         â”‚
â”‚   âŒ Blocked:                                           â”‚
â”‚   ğŸš« Random desks calling HQ directly                  â”‚
â”‚   ğŸš« Outside calls without proper credentials          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Why port 10250 matters**: When you run `kubectl exec`, `kubectl logs`, or `kubectl port-forward`, Campus Management needs to reach back to the Room Manager. If blocked, these commands fail!

---

## High Availability - Campus Never Closes

Campus Management takes reliability seriously:

- **Multiple reception desks (API Servers)** across different locations
- **3 copies of all records (etcd)** stored in 3 separate facilities in different parts of the city (Availability Zones)
- If one facility has issues, the others continue operating seamlessly

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               CAMPUS MANAGEMENT SETUP                       â”‚
â”‚                                                             â”‚
â”‚   Location A (AZ-a)    Location B (AZ-b)    Location C (AZ-c)
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚ Reception   â”‚      â”‚ Reception   â”‚      â”‚ Reception   â”‚ â”‚
â”‚   â”‚ (API Server)â”‚      â”‚ (API Server)â”‚      â”‚ (API Server)â”‚ â”‚
â”‚   â”‚             â”‚      â”‚             â”‚      â”‚             â”‚ â”‚
â”‚   â”‚ Records ğŸ“  â”‚â—„â”€â”€â”€â”€â–ºâ”‚ Records ğŸ“  â”‚â—„â”€â”€â”€â”€â–ºâ”‚ Records ğŸ“  â”‚ â”‚
â”‚   â”‚ (etcd copy) â”‚ sync â”‚ (etcd copy) â”‚ sync â”‚ (etcd copy) â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚   If Location A goes down â†’ B & C continue operating       â”‚
â”‚   99.95% uptime SLA guaranteed                             â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Cost Considerations

| Component | Cost |
|-----------|------|
| **EKS Cluster** (Control Plane) | $0.10/hour (~$73/month) |
| **Worker Nodes** | Standard EC2 pricing (you choose instance type) |
| **Fargate** | Per vCPU + memory (~20% premium over EC2) |
| **Auto Mode** | Control plane + additional per-node fee |

**Cost Optimization Tips**:
- Use **Managed Node Groups** with **Spot Instances** for non-critical workloads
- Use **Karpenter** for intelligent right-sizing
- Use **Fargate** for bursty, unpredictable workloads

---

## Why Use a Managed Campus (EKS) Instead of Building Your Own?

Without EKS, you would need to:
- Launch EC2 instances manually
- Install container runtime (containerd)
- Install and configure API Server, etcd, Controller Manager, Scheduler
- Set up networking (CNI plugins)
- Handle certificates and security
- Manage upgrades and patches yourself
- Ensure high availability

With EKS:
- âœ… Control plane is fully managed
- âœ… Automatic upgrades available
- âœ… Built-in high availability
- âœ… Integrated with AWS services (IAM, VPC, ELB, etc.)
- âœ… You focus on deploying applications

---

## Key Takeaways

1. **EKS = Managed Kubernetes** - AWS handles the hard parts of running K8s
2. **VPC = Campus, Subnets = Buildings, Nodes = Rooms, Pods = Desks**
3. **Standard Mode** - AWS manages control plane, you manage rooms (nodes)
4. **Auto Mode** - AWS manages everything, you just deploy desks (pods)
5. **Control Plane is in AWS's VPC** - but ENIs (phone panels) are injected into your buildings for private communication
6. **Choose compute wisely** - Managed Node Groups for balance, Fargate for serverless, Karpenter for cost optimization
7. **Private endpoint = more secure** - traffic stays internal
8. **Cluster Security Group** - controls room â†” campus management communication
9. **HA is built-in** - multi-AZ API servers and etcd, 99.95% SLA

---

*Written on December 2, 2025*
