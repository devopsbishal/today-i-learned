# EKS Upgrades & Maintenance - The Building Renovation

> Understanding EKS cluster upgrades, node update strategies, and version management through control plane and data plane upgrades - continuing the office campus analogy.

---

## TL;DR

| EKS Upgrades Concept | Office Campus Analogy |
|---------------------|----------------------|
| Kubernetes Version Upgrade | Building modernization (upgrading facilities) |
| Control Plane Upgrade | Management office upgrade (no tenant impact) |
| Worker Node Upgrade | Office floor renovation (where employees work) |
| Rolling Update | Renovate one floor at a time, move people temporarily |
| Blue/Green Deployment | Build new wing, move everyone, demolish old |
| Version Skew Policy (n-2) | Old floors can be 2 generations behind main building |
| 14-month Standard Support | Free building maintenance period |
| 12-month Extended Support | Pay premium ($0.60/hr) for outdated systems |
| Auto-upgrade after EOL | City forces building code compliance |
| Cannot Skip Versions | Must upgrade step-by-step (2020â†’2022â†’2024) |
| EKS Addons | Building utilities (plumbing, HVAC, electrical) |
| Addon Compatibility | Utilities must match building standards |
| Pod Disruption Budget | Minimum staff on duty during renovation |
| Node Drain | Evacuate floor before renovation |
| Cordon | Close floor to new occupants |
| Pre-upgrade Testing | Test renovation in building's test wing |

---

## The Upgrade Challenge

Your office campus (cluster) needs regular modernization to stay current:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              WHY UPGRADE YOUR BUILDING?                     â”‚
â”‚                                                             â”‚
â”‚  ğŸ”’ Security                                                â”‚
â”‚     Old building systems have known vulnerabilities        â”‚
â”‚                                                             â”‚
â”‚  ğŸ†• New Features                                            â”‚
â”‚     Modern amenities, better efficiency                     â”‚
â”‚                                                             â”‚
â”‚  ğŸ› Bug Fixes                                               â”‚
â”‚     Fixed elevator issues, HVAC improvements                â”‚
â”‚                                                             â”‚
â”‚  ğŸ“… Compliance                                              â”‚
â”‚     Meet current building codes                            â”‚
â”‚                                                             â”‚
â”‚  ğŸ’° Support Costs                                           â”‚
â”‚     Outdated systems cost more to maintain                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Version Lifecycle - Building Age Policy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           KUBERNETES VERSION LIFECYCLE                      â”‚
â”‚                                                             â”‚
â”‚  MONTH 0: New Version Released (e.g., K8s 1.30)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ†• Latest & Greatest                              â”‚    â”‚
â”‚  â”‚     All new features, fully supported              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  MONTH 1-14: Standard Support (FREE)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  âœ… Full AWS Support                               â”‚    â”‚
â”‚  â”‚  âœ… Security patches                               â”‚    â”‚
â”‚  â”‚  âœ… Bug fixes                                      â”‚    â”‚
â”‚  â”‚  ğŸ’° No extra cost                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  MONTH 15-26: Extended Support ($0.60/cluster-hour)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  âš ï¸ Limited support                                â”‚    â”‚
â”‚  â”‚  âœ… Critical security patches only                 â”‚    â”‚
â”‚  â”‚  âŒ No new features                                â”‚    â”‚
â”‚  â”‚  ğŸ’° $0.60/hour = ~$432/month per cluster           â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Use case: Need time to test upgrades             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  MONTH 27+: End of Life - AUTO UPGRADE!                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸš¨ AWS FORCE UPGRADES YOUR CLUSTER!              â”‚    â”‚
â”‚  â”‚     1.28 â†’ 1.29 (next oldest supported version)   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  âš ï¸ This happens automatically!                   â”‚    â”‚
â”‚  â”‚  âš ï¸ Could break your applications!                â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Best Practice: Upgrade every 3-6 months during standard  â”‚
â”‚  support period!                                           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Version Skew Policy - Building Compatibility Rules

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           VERSION SKEW POLICY (n-2)                         â”‚
â”‚                                                             â”‚
â”‚  Control Plane: K8s 1.30                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ğŸ¢ Management Building (Modern - 2024)            â”‚    â”‚
â”‚  â”‚     API Server, Scheduler, Controller Manager      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â”‚ n-2 skew allowed                â”‚
â”‚                          â–¼                                  â”‚
â”‚  Worker Nodes: Can be 1.28, 1.29, or 1.30                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Floor A   Floor B   Floor C                       â”‚    â”‚
â”‚  â”‚  (2022)    (2023)    (2024)                        â”‚    â”‚
â”‚  â”‚  K8s 1.28  K8s 1.29  K8s 1.30                     â”‚    â”‚
â”‚  â”‚  âœ… OK     âœ… OK     âœ… OK                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  âŒ INVALID: Control Plane 1.30, Nodes 1.27               â”‚
â”‚     3 versions behind = violates n-2 policy!               â”‚
â”‚                                                             â”‚
â”‚  âœ… VALID: Control Plane 1.30, Nodes 1.28                 â”‚
â”‚     2 versions behind = within n-2 policy                  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Why n-2 Matters

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Allows gradual upgrades without forcing all at once:      â”‚
â”‚                                                             â”‚
â”‚  Day 1:  Control Plane 1.28 â†’ 1.29                        â”‚
â”‚          Nodes stay at 1.28 (still compatible!)           â”‚
â”‚                                                             â”‚
â”‚  Week 2: Gradually upgrade node groups                     â”‚
â”‚          Nodes 1.28 â†’ 1.29                                 â”‚
â”‚                                                             â”‚
â”‚  Month 2: Control Plane 1.29 â†’ 1.30                       â”‚
â”‚           Nodes stay at 1.29 (still compatible!)          â”‚
â”‚                                                             â”‚
â”‚  âœ… Zero pressure to upgrade everything immediately!      â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## The Upgrade Sequence - Renovation Order

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MANDATORY UPGRADE ORDER                        â”‚
â”‚                                                             â”‚
â”‚  STEP 1: Control Plane (Management Office)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Upgrade: 1.28 â†’ 1.29                             â”‚    â”‚
â”‚  â”‚  Time: 20-30 minutes                               â”‚    â”‚
â”‚  â”‚  Downtime: ZERO for applications                   â”‚    â”‚
â”‚  â”‚  AWS handles: Rolling update of API servers        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â–¼                                  â”‚
â”‚  STEP 2: EKS Addons (Building Utilities)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  VPC CNI:    1.15.x â†’ 1.16.x                      â”‚    â”‚
â”‚  â”‚  CoreDNS:    1.10.x â†’ 1.11.x                      â”‚    â”‚
â”‚  â”‚  kube-proxy: 1.28.x â†’ 1.29.x                      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Check compatibility matrix first!                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â–¼                                  â”‚
â”‚  STEP 3: Worker Nodes (Office Floors)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Choose strategy:                                  â”‚    â”‚
â”‚  â”‚  â€¢ Rolling Update (slow, safe, cheaper)           â”‚    â”‚
â”‚  â”‚  â€¢ Blue/Green (fast, flexible, costly)            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  âš ï¸ CRITICAL: Cannot skip steps!                           â”‚
â”‚  âš ï¸ CRITICAL: Cannot skip versions (1.28 â†’ 1.30)!         â”‚
â”‚     Must go 1.28 â†’ 1.29 â†’ 1.30                            â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Control Plane Upgrade - Management Office Renovation

AWS handles control plane upgrades with **zero downtime** for your applications.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         CONTROL PLANE UPGRADE (AWS Managed)                 â”‚
â”‚                                                             â”‚
â”‚  Before: K8s 1.28                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  API Server 1   API Server 2   API Server 3       â”‚    â”‚
â”‚  â”‚  (1.28)        (1.28)          (1.28)             â”‚    â”‚
â”‚  â”‚  Scheduler      Controller Mgr  etcd               â”‚    â”‚
â”‚  â”‚  (1.28)        (1.28)          (1.28)             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â”‚ AWS performs rolling update     â”‚
â”‚                          â–¼                                  â”‚
â”‚  During Upgrade: Mixed versions temporarily                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  API Server 1   API Server 2   API Server 3       â”‚    â”‚
â”‚  â”‚  (1.29) âœ…     (1.28)          (1.28)             â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  One at a time, health checked before next        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â–¼                                  â”‚
â”‚  After: K8s 1.29                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  API Server 1   API Server 2   API Server 3       â”‚    â”‚
â”‚  â”‚  (1.29) âœ…     (1.29) âœ…       (1.29) âœ…          â”‚    â”‚
â”‚  â”‚  Scheduler      Controller Mgr  etcd               â”‚    â”‚
â”‚  â”‚  (1.29) âœ…     (1.29) âœ…       (1.29) âœ…          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  âœ… Applications keep running on worker nodes!            â”‚
â”‚  âœ… API requests handled throughout upgrade!              â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### How to Upgrade Control Plane

```bash
# Via AWS CLI
aws eks update-cluster-version \
  --name my-cluster \
  --kubernetes-version 1.29

# Via AWS Console
# EKS â†’ Clusters â†’ my-cluster â†’ Update now

# Monitor upgrade status
aws eks describe-update \
  --name my-cluster \
  --update-id <update-id>
```

---

## Worker Node Upgrades - Floor Renovation

Two main strategies: **Rolling Update** vs **Blue/Green**

### Strategy 1: Rolling Update - One Floor at a Time

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ROLLING UPDATE STRATEGY                        â”‚
â”‚                                                             â”‚
â”‚  Initial State: 4 nodes on K8s 1.28                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Node 1    Node 2    Node 3    Node 4             â”‚    â”‚
â”‚  â”‚  (1.28)    (1.28)    (1.28)    (1.28)             â”‚    â”‚
â”‚  â”‚  ğŸ¢ğŸ¢ğŸ¢    ğŸ¢ğŸ¢      ğŸ¢ğŸ¢      ğŸ¢                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Step 1: Cordon Node 1 (close to new tenants)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Node 1    Node 2    Node 3    Node 4             â”‚    â”‚
â”‚  â”‚  ğŸš«(1.28)  (1.28)    (1.28)    (1.28)             â”‚    â”‚
â”‚  â”‚            ğŸ¢ğŸ¢      ğŸ¢ğŸ¢      ğŸ¢                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Step 2: Drain Node 1 (evacuate tenants)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Node 1    Node 2    Node 3    Node 4             â”‚    â”‚
â”‚  â”‚  ğŸš«(1.28)  (1.28)    (1.28)    (1.28)             â”‚    â”‚
â”‚  â”‚  [EMPTY]   ğŸ¢ğŸ¢ğŸ¢ğŸ¢  ğŸ¢ğŸ¢ğŸ¢    ğŸ¢ğŸ¢              â”‚    â”‚
â”‚  â”‚            â†‘ Pods moved here                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Step 3: Upgrade Node 1 â†’ 1.29                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Node 1    Node 2    Node 3    Node 4             â”‚    â”‚
â”‚  â”‚  âœ…(1.29)  (1.28)    (1.28)    (1.28)             â”‚    â”‚
â”‚  â”‚  ğŸ¢        ğŸ¢ğŸ¢ğŸ¢ğŸ¢  ğŸ¢ğŸ¢ğŸ¢    ğŸ¢ğŸ¢              â”‚    â”‚
â”‚  â”‚  â†‘ Uncordoned, accepting pods again                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Repeat for Node 2, 3, 4...                                â”‚
â”‚                                                             â”‚
â”‚  Final State: All nodes on 1.29                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Node 1    Node 2    Node 3    Node 4             â”‚    â”‚
â”‚  â”‚  (1.29)    (1.29)    (1.29)    (1.29)             â”‚    â”‚
â”‚  â”‚  ğŸ¢ğŸ¢      ğŸ¢ğŸ¢ğŸ¢    ğŸ¢ğŸ¢      ğŸ¢                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  âœ… Pros: Cost effective, no extra resources               â”‚
â”‚  âš ï¸ Cons: Slow (one at a time), temporary capacity loss   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Rolling Update Configuration

```yaml
# Managed Node Group Update Config
updateConfig:
  maxUnavailable: 1        # Max nodes unavailable at once
  # OR
  maxUnavailablePercentage: 33  # Max 33% unavailable
```

```bash
# Update managed node group
aws eks update-nodegroup-version \
  --cluster-name my-cluster \
  --nodegroup-name my-nodes \
  --kubernetes-version 1.29
```

---

### Strategy 2: Blue/Green - Build New Wing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            BLUE/GREEN DEPLOYMENT STRATEGY                   â”‚
â”‚                                                             â”‚
â”‚  PHASE 1: Current State (BLUE)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Blue Node Group (K8s 1.28)                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ Node 1  Node 2  Node 3  Node 4           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ ğŸ¢ğŸ¢   ğŸ¢ğŸ¢    ğŸ¢ğŸ¢    ğŸ¢             â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  100% of traffic here                             â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  PHASE 2: Create GREEN node group                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Blue Node Group (K8s 1.28)                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ Node 1  Node 2  Node 3  Node 4           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ ğŸ¢ğŸ¢   ğŸ¢ğŸ¢    ğŸ¢ğŸ¢    ğŸ¢             â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚  100% traffic                                      â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Green Node Group (K8s 1.29) - NEW!               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ Node 5  Node 6  Node 7  Node 8           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ [EMPTY] [EMPTY] [EMPTY] [EMPTY]          â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚  0% traffic (ready but not used)                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  PHASE 3: Cordon BLUE (stop new pods)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Blue Node Group (CORDONED)                       â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ ğŸš«      ğŸš«      ğŸš«      ğŸš«               â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ ğŸ¢ğŸ¢   ğŸ¢ğŸ¢    ğŸ¢ğŸ¢    ğŸ¢             â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Green Node Group                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ Node 5  Node 6  Node 7  Node 8           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ ğŸ¢      ğŸ¢      ğŸ¢      ğŸ¢               â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚  â†‘ New pods go here!                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  PHASE 4: Gradually drain BLUE nodes                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Blue: 30% traffic â†’ 0% traffic (over hours)      â”‚    â”‚
â”‚  â”‚  Green: 70% traffic â†’ 100% traffic                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  PHASE 5: Delete BLUE node group                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Green Node Group (K8s 1.29)                      â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚
â”‚  â”‚  â”‚ Node 5  Node 6  Node 7  Node 8           â”‚     â”‚    â”‚
â”‚  â”‚  â”‚ ğŸ¢ğŸ¢   ğŸ¢ğŸ¢    ğŸ¢ğŸ¢    ğŸ¢             â”‚     â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚
â”‚  â”‚  100% traffic                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  âœ… Pros: Fast, easy rollback, gradual traffic shift      â”‚
â”‚  âš ï¸ Cons: 2x resources during transition (costly!)        â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Blue/Green Steps

```bash
# 1. Create GREEN node group with new version
aws eks create-nodegroup \
  --cluster-name my-cluster \
  --nodegroup-name green-nodes \
  --kubernetes-version 1.29 \
  --subnets subnet-xxx subnet-yyy \
  --node-role arn:aws:iam::123:role/NodeRole

# 2. Wait for GREEN nodes to be ready
kubectl get nodes

# 3. Cordon BLUE nodes (stop new pods)
kubectl cordon -l nodegroup=blue-nodes

# 4. Gradually drain BLUE nodes
kubectl drain <blue-node-name> --ignore-daemonsets --delete-emptydir-data

# 5. Verify apps on GREEN nodes
kubectl get pods -o wide

# 6. Delete BLUE node group
aws eks delete-nodegroup \
  --cluster-name my-cluster \
  --nodegroup-name blue-nodes
```

---

## Rolling vs Blue/Green Decision Guide

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  Use ROLLING UPDATE when:                                  â”‚
â”‚  âœ… Cost-sensitive (no 2x capacity needed)                 â”‚
â”‚  âœ… Can tolerate gradual rollout (hours)                   â”‚
â”‚  âœ… Have good Pod Disruption Budgets                       â”‚
â”‚  âœ… Low-risk upgrade (minor version bump)                  â”‚
â”‚  âœ… Dev/staging environments                               â”‚
â”‚                                                             â”‚
â”‚  Use BLUE/GREEN when:                                      â”‚
â”‚  âœ… Need fast rollback capability                          â”‚
â”‚  âœ… Zero-downtime critical (e-commerce, finance)           â”‚
â”‚  âœ… Want to test new version in production traffic         â”‚
â”‚  âœ… Major version upgrade (higher risk)                    â”‚
â”‚  âœ… Can afford 2x capacity temporarily                     â”‚
â”‚  âœ… Production environments                                â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Pod Disruption Budgets - Safety During Renovation

PDBs ensure **minimum availability** during node drains.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          POD DISRUPTION BUDGET (PDB)                        â”‚
â”‚                                                             â”‚
â”‚  Scenario: 5 replicas, PDB minAvailable: 4                â”‚
â”‚                                                             â”‚
â”‚  Before Drain:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Node 1      Node 2      Node 3                    â”‚    â”‚
â”‚  â”‚  ğŸ¢ğŸ¢       ğŸ¢ğŸ¢       ğŸ¢                         â”‚    â”‚
â”‚  â”‚  Pod 1,2    Pod 3,4    Pod 5                       â”‚    â”‚
â”‚  â”‚  5 pods running âœ…                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Drain Node 1 Attempt:                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Kubernetes: "Can I evict Pod 1?"                  â”‚    â”‚
â”‚  â”‚  PDB: "Check: 5 running - 1 evict = 4 remaining"  â”‚    â”‚
â”‚  â”‚        "4 >= minAvailable(4)? YES! âœ…"            â”‚    â”‚
â”‚  â”‚        "ALLOW eviction"                            â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  Kubernetes: "Can I evict Pod 2?"                  â”‚    â”‚
â”‚  â”‚  PDB: "Check: 4 running - 1 evict = 3 remaining"  â”‚    â”‚
â”‚  â”‚        "3 >= minAvailable(4)? NO! âŒ"             â”‚    â”‚
â”‚  â”‚        "BLOCK eviction - wait for Pod 1 to start" â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  After Pod 1 reschedules on Node 2:                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Node 1      Node 2      Node 3                    â”‚    â”‚
â”‚  â”‚  ğŸ¢          ğŸ¢ğŸ¢ğŸ¢     ğŸ¢                         â”‚    â”‚
â”‚  â”‚  Pod 2      Pod 1,3,4  Pod 5                       â”‚    â”‚
â”‚  â”‚  Now can evict Pod 2! (5-1=4 >= minAvailable)     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  PDB protects application availability! ğŸ›¡ï¸                 â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### PDB Example

```yaml
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: api-server-pdb
spec:
  minAvailable: 4        # At least 4 pods must be available
  # OR
  # maxUnavailable: 1    # Max 1 pod can be down at a time
  selector:
    matchLabels:
      app: api-server
```

```yaml
# Alternative: percentage-based
apiVersion: policy/v1
kind: PodDisruptionBudget
metadata:
  name: worker-pdb
spec:
  maxUnavailable: 25%    # Max 25% can be down
  selector:
    matchLabels:
      app: background-worker
```

---

## EKS Addons - Building Utilities Upgrade

Three critical addons need version compatibility checks:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EKS ADDONS (Building Utilities)                â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ”Œ VPC CNI (Networking Plumbing)                 â”‚    â”‚
â”‚  â”‚     Gives pods IP addresses                       â”‚    â”‚
â”‚  â”‚     Version must match K8s version                â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸŒ CoreDNS (Building Directory)                  â”‚    â”‚
â”‚  â”‚     DNS resolution for services                   â”‚    â”‚
â”‚  â”‚     Version must match K8s version                â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â”‚  ğŸ”€ kube-proxy (Network Routing)                  â”‚    â”‚
â”‚  â”‚     Routes traffic to pods                        â”‚    â”‚
â”‚  â”‚     Version matches K8s version                   â”‚    â”‚
â”‚  â”‚                                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Compatibility Matrix Example:                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  K8s 1.29:                                         â”‚    â”‚
â”‚  â”‚  â€¢ VPC CNI: 1.16.x - 1.18.x                       â”‚    â”‚
â”‚  â”‚  â€¢ CoreDNS: 1.11.x                                 â”‚    â”‚
â”‚  â”‚  â€¢ kube-proxy: 1.29.x                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Check compatibility: https://docs.aws.amazon.com/eks/     â”‚
â”‚  latest/userguide/managing-add-ons.html                    â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Updating Addons

```bash
# List current addon versions
aws eks describe-addon-versions \
  --kubernetes-version 1.29

# Update VPC CNI addon
aws eks update-addon \
  --cluster-name my-cluster \
  --addon-name vpc-cni \
  --addon-version v1.16.0-eksbuild.1 \
  --resolve-conflicts OVERWRITE

# Update CoreDNS addon
aws eks update-addon \
  --cluster-name my-cluster \
  --addon-name coredns \
  --addon-version v1.11.1-eksbuild.4

# Update kube-proxy addon
aws eks update-addon \
  --cluster-name my-cluster \
  --addon-name kube-proxy \
  --addon-version v1.29.0-eksbuild.1
```

---

## Pre-Upgrade Checklist - Testing in Test Wing

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              PRE-UPGRADE CHECKLIST                          â”‚
â”‚                                                             â”‚
â”‚  â˜ 1. Review Release Notes                                 â”‚
â”‚     Check breaking changes, deprecated APIs                â”‚
â”‚     https://kubernetes.io/docs/setup/release/notes/        â”‚
â”‚                                                             â”‚
â”‚  â˜ 2. Test in Non-Production First                         â”‚
â”‚     Dev â†’ Staging â†’ Production                             â”‚
â”‚     Never upgrade production first!                        â”‚
â”‚                                                             â”‚
â”‚  â˜ 3. Check Deprecated APIs                                â”‚
â”‚     kubectl get --raw /metrics | grep deprecated           â”‚
â”‚     Use: https://github.com/doitintl/kube-no-trouble       â”‚
â”‚                                                             â”‚
â”‚  â˜ 4. Verify Addon Compatibility                           â”‚
â”‚     Check VPC CNI, CoreDNS, kube-proxy versions            â”‚
â”‚                                                             â”‚
â”‚  â˜ 5. Review Application Dependencies                      â”‚
â”‚     Check if apps use deprecated K8s APIs                  â”‚
â”‚                                                             â”‚
â”‚  â˜ 6. Create Pod Disruption Budgets                        â”‚
â”‚     Ensure apps have PDBs for critical services            â”‚
â”‚                                                             â”‚
â”‚  â˜ 7. Backup Critical Data                                 â”‚
â”‚     Kubernetes manifests (Velero), EBS snapshots, RDS data â”‚
â”‚                                                             â”‚
â”‚  â˜ 8. Plan Maintenance Window                              â”‚
â”‚     Inform stakeholders, schedule low-traffic time         â”‚
â”‚                                                             â”‚
â”‚  â˜ 9. Prepare Rollback Plan                                â”‚
â”‚     How to revert if issues occur?                         â”‚
â”‚                                                             â”‚
â”‚  â˜ 10. Monitor Post-Upgrade                                â”‚
â”‚      Watch logs, metrics, alerts for 24-48 hours           â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Detecting Deprecated APIs

```bash
# Install kube-no-trouble (kubent)
brew install kubent
# OR: sh -c "$(curl -sSL https://git.io/install-kubent)"

# Check for deprecated API usage
kubent

# Example output:
# API: extensions/v1beta1/Ingress
# DEPRECATED IN: v1.14
# REMOVED IN: v1.22
# FILE: ingress.yaml
```

---

## Common Deprecated APIs

| API Version | Replaced By | Removed In |
|-------------|-------------|------------|
| `extensions/v1beta1/Ingress` | `networking.k8s.io/v1/Ingress` | 1.22 |
| `rbac.authorization.k8s.io/v1beta1` | `rbac.authorization.k8s.io/v1` | 1.22 |
| `apiextensions.k8s.io/v1beta1` | `apiextensions.k8s.io/v1` | 1.22 |
| `batch/v1beta1/CronJob` | `batch/v1/CronJob` | 1.25 |
| `policy/v1beta1/PodDisruptionBudget` | `policy/v1/PodDisruptionBudget` | 1.25 |
| `autoscaling/v2beta2/HPA` | `autoscaling/v2/HPA` | 1.26 |

---

## The Complete Upgrade Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              COMPLETE UPGRADE WORKFLOW                          â”‚
â”‚                                                                 â”‚
â”‚  Week 1: Preparation                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  â€¢ Read release notes                                     â”‚ â”‚
â”‚  â”‚  â€¢ Check deprecated APIs                                  â”‚ â”‚
â”‚  â”‚  â€¢ Verify addon compatibility                             â”‚ â”‚
â”‚  â”‚  â€¢ Create/update Pod Disruption Budgets                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚  Week 2: Dev Cluster Upgrade                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1. Upgrade control plane (1.28 â†’ 1.29)                  â”‚ â”‚
â”‚  â”‚  2. Update addons (VPC CNI, CoreDNS, kube-proxy)         â”‚ â”‚
â”‚  â”‚  3. Rolling update worker nodes                           â”‚ â”‚
â”‚  â”‚  4. Test applications thoroughly                          â”‚ â”‚
â”‚  â”‚  5. Document any issues found                             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚  Week 3: Staging Cluster Upgrade                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Repeat same steps as Dev                                 â”‚ â”‚
â”‚  â”‚  Run integration tests, load tests                        â”‚ â”‚
â”‚  â”‚  Monitor for 48 hours                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚  Week 4: Production Upgrade                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  BEFORE:                                                  â”‚ â”‚
â”‚  â”‚  â€¢ Schedule maintenance window (low traffic)              â”‚ â”‚
â”‚  â”‚  â€¢ Notify stakeholders                                    â”‚ â”‚
â”‚  â”‚  â€¢ Prepare rollback plan                                  â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  DURING:                                                  â”‚ â”‚
â”‚  â”‚  1. Upgrade control plane â†’ 20-30 min                    â”‚ â”‚
â”‚  â”‚  2. Update addons â†’ 10-15 min                            â”‚ â”‚
â”‚  â”‚  3. Blue/Green node upgrade â†’ 2-4 hours                  â”‚ â”‚
â”‚  â”‚     OR Rolling update â†’ 4-8 hours                        â”‚ â”‚
â”‚  â”‚                                                           â”‚ â”‚
â”‚  â”‚  AFTER:                                                   â”‚ â”‚
â”‚  â”‚  â€¢ Monitor metrics, logs, alerts (24-48 hours)           â”‚ â”‚
â”‚  â”‚  â€¢ Check application health                              â”‚ â”‚
â”‚  â”‚  â€¢ Document upgrade completion                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Quick Reference

| Component | Upgrade Time | Downtime | Can Skip Versions? |
|-----------|-------------|----------|-------------------|
| Control Plane | 20-30 min | Zero | âŒ No (1.28â†’1.29â†’1.30) |
| EKS Addons | 10-15 min | Zero | âŒ No |
| Nodes (Rolling) | 4-8 hours | Per-node | âŒ No |
| Nodes (Blue/Green) | 2-4 hours | Zero | âŒ No |

---

## Common Pitfalls

| Problem | Solution |
|---------|----------|
| **Forgot to check deprecated APIs** | Use kubent/kube-no-trouble before upgrade |
| **No Pod Disruption Budgets** | Create PDBs for all critical services |
| **Upgraded production first** | Always upgrade dev â†’ staging â†’ prod |
| **Skipped versions (1.28â†’1.30)** | Must go one version at a time |
| **Addons incompatible** | Check compatibility matrix first |
| **Node drain stuck** | Check for pods without PDB, DaemonSets |
| **Didn't test in non-prod** | Test thoroughly in dev/staging first |

---

## Key Takeaways

1. **Version Support**: 14 months free, 12 months extended ($0.60/hr), then auto-upgrade
2. **Version Skew (n-2)**: Nodes can be up to 2 minor versions behind control plane
3. **Cannot Skip Versions**: Must upgrade 1.28 â†’ 1.29 â†’ 1.30 (one at a time)
4. **Upgrade Order**: Control Plane â†’ Addons â†’ Worker Nodes
5. **Control Plane**: Zero downtime, AWS manages rolling update
6. **Rolling Update**: Cost-effective, slower, one node at a time
7. **Blue/Green**: Fast, easy rollback, but 2x resources during transition
8. **Pod Disruption Budgets**: Critical for maintaining availability during drain
9. **Test First**: Always upgrade dev â†’ staging â†’ production
10. **Check Deprecated APIs**: Use kubent to find deprecated API usage before upgrade

---

## Related Reading

- [AWS VPC - The Compound Analogy](../november/2025-11-30-aws-vpc.md)
- [AWS EKS - The Managed Office Building Analogy](./2025-12-02-aws-eks.md)
- [AWS VPC CNI - The Phone Extension System](./2025-12-03-aws-vpc-cni.md)
- [EKS Networking - The Mail & Delivery System](./2025-12-09-eks-networking.md)
- [EKS IAM - The Employee Badge System](./2025-12-10-eks-iam-irsa-pod-identity.md)
- [EKS Storage - The Locker & Storage Room System](./2025-12-11-eks-storage.md)
- [EKS Autoscaling - The Staffing & Workspace Management](./2025-12-12-eks-autoscaling.md)
- [EKS Security - The Corporate Security System](./2025-12-14-eks-security.md)
- [EKS Observability - The Building Operations Center](./2025-12-16-eks-observability.md)

---

*Written on December 19, 2025*
